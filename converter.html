
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script src="papaparse.js"></script>
<script type="text/javascript">



var spreadsheet_id = gup('spreadsheet_id');
var sheet_id = gup('sheet_id');

download_url = 'https://docs.google.com/spreadsheets/d/'+ spreadsheet_id +'/export?format=csv&id='+ spreadsheet_id
    
if (sheet_id != ""){download_url += '&gid='+ sheet_id}
download_url += '&callback=googleDocCallback'
    
console.log (download_url);
    
Papa.parse(download_url, {
        download: true
    },
    {
        complete: function(results) {
            console.log(results);
    }
});

window.googleDocCallback = function () { return true; };        

function gup(name) {
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+name+"=([^&#]*)";
  var regex = new RegExp( regexS );
  var results = regex.exec( window.location.href );
  if( results == null )
    return "";
  else
    return results[1];
}
    
</script>

</head>

<body>

</body>
</html>
//
